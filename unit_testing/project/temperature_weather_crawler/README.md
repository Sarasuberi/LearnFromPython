# 爬虫实现的基本思路流程
## 一、数据来源分析
### 1.明确需求
<font color='#a63636'> 明确采集的网站以及数据 <font>
    - 网站地址：https://lishi.tianqi.com/kunshan/index.html
    - 数据：历史天气数据（日期/最高/最低/天气/风向）

### 2.抓包分析
<font color='#a63636'> 通过浏览器的开发者工具分析对应的数据 <font>
    - 打开开发者工具
        * F12/右键点击检查选择network（网络）
    - 刷新网页
        * 让本网页的数据内容重新加载一遍（请求和响应）
    - 通过关键字搜索，找到对应的数据位置
        * 关键字搜索：需要什么数据就搜索什么

### 为什么有时候搜索没有返回数据呢？
    1.可能没有刷新网页/你想要的数据没有加载
    2.可能数据存在加密处理（编码问题/返回响应数据加密）

## 二、代码实现步骤
### 1.发送请求
<font color='#a63636'> 模拟浏览器对于url地址发送请求 <font>

#### 模拟浏览器
    使用请求标头中参数内容，在代码中用字典接收

#### 请求网址
    刚刚抓包找到的链接地址

#### 发送请求
    使用第三方模块requests
    - 请求方法：
        GET请求：requests.get(url,headers=headers)
        POST请求：requests.post(url,headers=headers,data=data)
    - 请求参数：
        GET请求：查询参数->显性，参数是在链接中就有的
        POST请求：表单数据/请求载荷->隐性，参数在载荷（负载）中查看

### 2.获取数据
<font color='#a63636'> 获取服务器返回响应数据 <font>

#### response.test
    - 获取响应的文本数据，返回字符串
#### response.json
    - 获取响应的json数据，返回字典/列表
#### response.content
    - 获取响应的二进制数据，返回二进制

### 3.解析数据
<font color='#a63636'> 提取自己需要的数据 <font>

#### 解析方法
    - 正则表达式：通过元字符对于字符串数据进行提取
    - CSS选择器：根据标签属性提取数据内容
    - XPath：根据标签节点提取数据内容
    - json解析：字典取值/列表取值
    - 直接处理：字符串方法/索引取值/切片

#### 如何选择解析方法？
    1.根据返回数据进行选择
    2.如果存在多种方法可以选择可以选择方便的，你喜欢的

#### 当得不到数据的时候
    被反爬了
        1.请求头伪装是否不够
            - 某些时候可能只是添加UA，伪装参数不够
        2.可能采集频率过快/过高，导致IP一场/账号异常/验证码/风控
            - 本地浏览器刷新如果能正常刷新可以排除这个问题
        3.可能存在参数加密
            - 请求头参数/请求参数/响应数据

### 4.保存数据
<font color='#a63636'> 将数据保存到本地 <font>

## 请求参数逆向分析
### 1.通过开发者工具定位加密位置
        定位加密位置方法：
            1.xhr断点
            2.搜索关键字
            3.hook
            4.根据启动器跟栈
            
### 2.断点调试分析
        JS逆向 -> JS调试 -> 断点调试
        加密参数/内容都是通过JS代码生成的
        通过开发者工具分析加密/解密JS代码位置，调用了什么方法

### 3.需要工具
# 1.浏览器
    - 谷歌浏览器

# 2.调试工具
    - F12/右键点击检查选择network（网络）

# 3.代码执行工具
    - nodejs
        ``编译并执行js代码``
    - pyexecjs
        ``python执行js代码``
    - requests
        ``python发送请求``
    - parsel
        ``python解析数据``
    - pandas
        ``python保存数据``
    - pyecharts
        ``python可视化数据``
    - crypto-js模块
        ``js加密模块``

### 4.安装
        pip install pyexecjs
        pip install pyexecjs
        pip install parsel
        pip install requests
        pip install pandas